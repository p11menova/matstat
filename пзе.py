# Импорт необходимых библиотек
import numpy as np
import scipy.stats as stats

# Данные
data = [
    10.0, 10.35, 11.5, 11.76, 12.25, 12.649999999999999, 12.75, 12.76, 12.899999999999999, 13.2, 13.2,
    13.200000000000001, 13.200000000000001, 13.200000000000001, 13.640000000000002, 13.75, 14.0, 14.040000000000001,
    14.080000000000002, 14.25, 14.26, 14.3, 14.399999999999999, 14.399999999999999, 14.489999999999998, 14.700000000000001,
    14.719999999999999, 14.82, 14.879999999999999, 15.0, 15.040000000000001, 15.040000000000001, 15.08, 15.12,
    15.190000000000001, 15.190000000000001, 15.639999999999999, 15.66, 15.66, 15.66, 15.66, 15.679999999999998, 15.75,
    15.75, 15.86, 15.959999999999999, 15.959999999999999, 16.0, 16.200000000000003, 16.200000000000003, 16.24, 16.24,
    16.32, 16.32, 16.5, 16.53, 16.56, 16.75, 16.799999999999997, 16.799999999999997, 16.83, 17.0, 17.0, 17.01, 17.08,
    17.08, 17.1, 17.28, 17.34, 17.36, 17.4, 17.5, 17.5, 17.639999999999997, 17.64, 17.68, 17.689999999999998,
    17.700000000000003, 17.700000000000003, 17.849999999999998, 17.849999999999998, 17.919999999999998, 17.919999999999998,
    17.98, 18.0, 18.0, 18.2, 18.2, 18.27, 18.299999999999997, 18.299999999999997, 18.36, 18.36, 18.56, 18.87,
    18.880000000000003, 19.04, 19.139999999999997, 19.25, 19.38, 19.38, 19.38, 19.5, 19.5, 19.5, 19.61,
    19.799999999999997, 19.840000000000003, 19.980000000000004, 20.02, 20.1, 20.1, 20.4, 20.4, 20.480000000000004,
    20.480000000000004, 20.72, 20.77, 20.77, 20.77, 20.79, 20.79, 20.8, 21.060000000000002, 21.060000000000002,
    21.08, 21.169999999999998, 21.299999999999997, 21.32, 21.39, 21.39, 21.39, 21.419999999999998, 21.56, 21.6, 21.66,
    21.76, 22.080000000000002, 22.11, 22.11, 22.400000000000002, 22.799999999999997, 23.040000000000003, 23.1, 23.1,
    23.2, 25.080000000000002, 25.92, 29.259999999999998, 30.02
]

# Оценка параметров нормального распределения методом моментов
mu_mom = np.mean(data)  # Оценка математического ожидания
sigma_mom = np.std(data, ddof=0)  # Оценка стандартного отклонения (по выборке)

# Теоретическое смещение, дисперсия и MSE оценки математического ожидания
n = len(data)
E_mu = mu_mom  # Несмещенная оценка математического ожидания
Var_mu = sigma_mom**2 / n  # Дисперсия оценки среднего
MSE_mu = Var_mu  # Так как оценка несмещенная

# Оценка параметров методом максимального правдоподобия (ММП)
mu_mle, sigma_mle = stats.norm.fit(data)  # Оценка параметров

# Информация Фишера (для нормального распределения)
I_mu = n / sigma_mle**2  # Информация Фишера для оценки матожидания
I_sigma = n / (2 * sigma_mle**2)  # Информация Фишера для оценки дисперсии

# Вывод результатов
results = {
    "Метод моментов": {"Оценка мат. ожидания": mu_mom, "Оценка стандартного отклонения": sigma_mom},
    "Метод максимального правдоподобия": {"Оценка мат. ожидания": mu_mle, "Оценка стандартного отклонения": sigma_mle},
    "Статистические свойства оценки": {
        "Смещение": 0,  # Оценка несмещенная
        "Дисперсия оценки среднего": Var_mu,
        "Среднеквадратическая ошибка (MSE)": MSE_mu,
        "Информация Фишера (для μ)": I_mu,
        "Информация Фишера (для σ)": I_sigma
    }
}


print(results)